---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.15.0
    api-approved.kubernetes.io: "https://github.com/kubernetes-csi/external-snapshotter/pull/814"
  name: volumesnapshots.snapshot.storage.k8s.io
  labels:
    heritage: deckhouse
    module: snapshot-controller
spec:
  group: snapshot.storage.k8s.io
  names:
    kind: VolumeSnapshot
    listKind: VolumeSnapshotList
    plural: volumesnapshots
    shortNames:
    - vs
    singular: volumesnapshot
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: Indicates if the snapshot is ready to be used to restore a volume.
      jsonPath: .status.readyToUse
      name: ReadyToUse
      type: boolean
    - description: If a new snapshot needs to be created, this contains the name of
        the source PVC from which this snapshot was (or will be) created.
      jsonPath: .spec.source.persistentVolumeClaimName
      name: SourcePVC
      type: string
    - description: If a snapshot already exists, this contains the name of the existing
        VolumeSnapshotContent object representing the existing snapshot.
      jsonPath: .spec.source.volumeSnapshotContentName
      name: SourceSnapshotContent
      type: string
    - description: Represents the minimum size of volume required to rehydrate from
        this snapshot.
      jsonPath: .status.restoreSize
      name: RestoreSize
      type: string
    - description: The name of the VolumeSnapshotClass requested by the VolumeSnapshot.
      jsonPath: .spec.volumeSnapshotClassName
      name: SnapshotClass
      type: string
    - description: Name of the VolumeSnapshotContent object to which the VolumeSnapshot
        object intends to bind to. Please note that verification of binding actually
        requires checking both VolumeSnapshot and VolumeSnapshotContent to ensure
        both are pointing at each other. Binding **must** be verified prior to usage of
        this object.
      jsonPath: .status.boundVolumeSnapshotContentName
      name: SnapshotContent
      type: string
    - description: Timestamp when the point-in-time snapshot was taken by the underlying
        storage system.
      jsonPath: .status.creationTime
      name: CreationTime
      type: date
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1
    schema:
      openAPIV3Schema:
        description: |-
          VolumeSnapshot is a user's request for either creating a point-in-time
          snapshot of a persistent volume, or binding to a pre-existing snapshot.
        properties:
          apiVersion:
            description: |-
              API version of this object representation. Servers convert recognized schemas
              to the latest internal value and may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind of REST resource this object represents. Servers may infer this value
              from the endpoint the client submits requests to. Cannot be updated
              after creation. Value must be in CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: |-
              Desired characteristics of a snapshot requested by a user.
              More info: https://kubernetes.io/docs/concepts/storage/volume-snapshots#volumesnapshots
            properties:
              source:
                description: |-
                  Specifies where a snapshot will be created from.
                  Immutable after creation.
                properties:
                  persistentVolumeClaimName:
                    description: |-
                      Name of the PersistentVolumeClaim object representing the volume
                      from which a snapshot should be created.
                      PVC must be in the same namespace as the VolumeSnapshot object.
                      Specified if the snapshot does not exist and needs to be created.
                      Immutable.
                    type: string
                    x-kubernetes-validations:
                    - message: persistentVolumeClaimName is immutable
                      rule: self == oldSelf
                  volumeSnapshotContentName:
                    description: |-
                      Name of a pre-existing VolumeSnapshotContent object representing
                      an existing volume snapshot.
                      Specified if the snapshot already exists and only needs a representation in Kubernetes.
                      Immutable.
                    type: string
                    x-kubernetes-validations:
                    - message: volumeSnapshotContentName is immutable
                      rule: self == oldSelf
                type: object
                x-kubernetes-validations:
                - message: persistentVolumeClaimName is required once set
                  rule: '!has(oldSelf.persistentVolumeClaimName) || has(self.persistentVolumeClaimName)'
                - message: volumeSnapshotContentName is required once set
                  rule: '!has(oldSelf.volumeSnapshotContentName) || has(self.volumeSnapshotContentName)'
                - message: exactly one of volumeSnapshotContentName and persistentVolumeClaimName
                    must be set
                  rule: (has(self.volumeSnapshotContentName) && !has(self.persistentVolumeClaimName))
                    || (!has(self.volumeSnapshotContentName) && has(self.persistentVolumeClaimName))
              volumeSnapshotClassName:
                description: |-
                  Name of the VolumeSnapshotClass requested by the VolumeSnapshot.
                  May be empty to use the default SnapshotClass.
                  A cluster may have multiple default Volume SnapshotClasses: one
                  per CSI Driver. If a SnapshotClass is not specified,
                  VolumeSnapshotSource is checked to determine the associated
                  CSI Driver, and the default VolumeSnapshotClass for that
                  CSI Driver is used. If multiple VolumeSnapshotClasses exist for
                  a CSI Driver and more than one is marked as default,
                  CreateSnapshot fails and generates an event.
                  Empty string is not allowed.
                type: string
                x-kubernetes-validations:
                - message: volumeSnapshotClassName must not be the empty string when
                    set
                  rule: size(self) > 0
            required:
            - source
            type: object
          status:
            description: |-
              Current information of a snapshot.
              Before using this object, verify that binding between VolumeSnapshot and
              VolumeSnapshotContent objects is successful by ensuring both
              objects point at each other.
            properties:
              boundVolumeSnapshotContentName:
                description: |-
                  Name of the VolumeSnapshotContent object to which this VolumeSnapshot
                  object is bound.
                  If not specified, the VolumeSnapshot object has not been
                  successfully bound to a VolumeSnapshotContent object yet.
                  **Note:** To prevent security issues, verify that binding between
                  VolumeSnapshot and VolumeSnapshotContent objects is successful by ensuring
                  both objects point at each other before using this object.
                type: string
              creationTime:
                description: |-
                  Timestamp when the point-in-time snapshot is taken by the underlying
                  storage system.
                  For dynamic snapshot creation, filled by the
                  snapshot controller with the `creation_time` value returned from CSI
                  `CreateSnapshot` gRPC call.
                  For a pre-existing snapshot, filled with the `creation_time`
                  value returned from the CSI `ListSnapshots` gRPC call if the driver supports it.
                  If not specified, the creation time of the snapshot is unknown.
                format: date-time
                type: string
              error:
                description: |-
                  Last observed error during snapshot creation, if any.
                  Useful to upper level controllers (i.e., application controller)
                  to decide whether to continue waiting for the snapshot to be created
                  based on the error type.
                  The snapshot controller keeps retrying when an error occurs during
                  snapshot creation. Upon success, the field is cleared.
                properties:
                  message:
                    description: |-
                      Details of the encountered error during snapshot creation
                      if specified.
                      **Note:** message may be logged, and it should not contain sensitive
                      information.
                    type: string
                  time:
                    description: |-
                      Timestamp when the error was encountered.
                    format: date-time
                    type: string
                type: object
              readyToUse:
                description: |-
                  Indicates if the snapshot is ready to be used to restore a volume.
                  For dynamic snapshot creation, filled by the
                  snapshot controller with the `ready_to_use` value returned from CSI
                  `CreateSnapshot` gRPC call.
                  For a pre-existing snapshot, filled with the `ready_to_use`
                  value returned from the CSI `ListSnapshots` gRPC call if the driver supports it,
                  otherwise set to `True`.
                  If not specified, the readiness of a snapshot is unknown.
                type: boolean
              restoreSize:
                type: string
                description: |-
                  Minimum size of volume required to create a volume from this snapshot.
                  For dynamic snapshot creation, filled by the
                  snapshot controller with the `size_bytes` value returned from CSI
                  `CreateSnapshot` gRPC call.
                  For a pre-existing snapshot, filled with the `size_bytes`
                  value returned from the CSI `ListSnapshots` gRPC call if the driver supports it.
                  When restoring a volume from this snapshot, the volume size **must not**
                  be smaller than the restoreSize if specified, otherwise the restoration will fail.
                  If not specified, the size is unknown.
                pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                x-kubernetes-int-or-string: true
              volumeGroupSnapshotName:
                description: |-
                  Name of the VolumeGroupSnapshot of which this VolumeSnapshot is a part.
                type: string
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
  - additionalPrinterColumns:
    - description: Indicates if the snapshot is ready to be used to restore a volume.
      jsonPath: .status.readyToUse
      name: ReadyToUse
      type: boolean
    - description: If a new snapshot needs to be created, this contains the name of the source PVC from which this snapshot was (or will be) created.
      jsonPath: .spec.source.persistentVolumeClaimName
      name: SourcePVC
      type: string
    - description: If a snapshot already exists, this contains the name of the existing VolumeSnapshotContent object representing the existing snapshot.
      jsonPath: .spec.source.volumeSnapshotContentName
      name: SourceSnapshotContent
      type: string
    - description: Represents the minimum size of volume required to rehydrate from this snapshot.
      jsonPath: .status.restoreSize
      name: RestoreSize
      type: string
    - description: The name of the VolumeSnapshotClass requested by the VolumeSnapshot.
      jsonPath: .spec.volumeSnapshotClassName
      name: SnapshotClass
      type: string
    - description: Name of the VolumeSnapshotContent object to which the VolumeSnapshot object intends to bind to. Please note that verification of binding actually requires checking both VolumeSnapshot and VolumeSnapshotContent to ensure both are pointing at each other. Binding **must** be verified prior to usage of this object.
      jsonPath: .status.boundVolumeSnapshotContentName
      name: SnapshotContent
      type: string
    - description: Timestamp when the point-in-time snapshot was taken by the underlying storage system.
      jsonPath: .status.creationTime
      name: CreationTime
      type: date
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1beta1
    # This indicates the v1beta1 version of the custom resource is deprecated.
    # API requests to this version receive a warning in the server response.
    deprecated: true
    # This overrides the default warning returned to clients making v1beta1 API requests.
    deprecationWarning: "snapshot.storage.k8s.io/v1beta1 VolumeSnapshot is deprecated; use snapshot.storage.k8s.io/v1 VolumeSnapshot"
    schema:
      openAPIV3Schema:
        description: |-
          VolumeSnapshot is a user's request for either creating a point-in-time snapshot of a persistent volume, or binding to a pre-existing snapshot.
        properties:
          apiVersion:
            description: |-
              API version of this object representation. Servers convert recognized schemas
              to the latest internal value and may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind of REST resource this object represents. Servers may infer this value
              from the endpoint the client submits requests to. Cannot be updated
              after creation. Value must be in CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          spec:
            description: |-
              Desired characteristics of a snapshot requested by a user.
              More info: https://kubernetes.io/docs/concepts/storage/volume-snapshots#volumesnapshots
            properties:
              source:
                description: |-
                  Specifies where a snapshot will be created from.
                  Immutable after creation.
                properties:
                  persistentVolumeClaimName:
                    description: |-
                      Name of the PersistentVolumeClaim object representing the volume
                      from which a snapshot should be created.
                      PVC must be in the same namespace as the VolumeSnapshot object.
                      Specified if the snapshot does not exist and needs to be created.
                      Immutable.
                    type: string
                  volumeSnapshotContentName:
                    description: |-
                      Name of a pre-existing VolumeSnapshotContent object representing
                      an existing volume snapshot.
                      Specified if the snapshot already exists and only needs a representation in Kubernetes.
                      Immutable.
                    type: string
                type: object
              volumeSnapshotClassName:
                description: |-
                  Name of the VolumeSnapshotClass requested by the VolumeSnapshot.
                  May be empty to use the default SnapshotClass.
                  A cluster may have multiple default Volume SnapshotClasses: one
                  per CSI Driver. If a SnapshotClass is not specified,
                  VolumeSnapshotSource is checked to determine the associated
                  CSI Driver, and the default VolumeSnapshotClass for that
                  CSI Driver is used. If multiple VolumeSnapshotClasses exist for
                  a CSI Driver and more than one is marked as default,
                  CreateSnapshot fails and generates an event.
                  Empty string is not allowed.
                type: string
            required:
            - source
            type: object
          status:
            description: |-
              Current information of a snapshot.
              Before using this object, verify that binding between VolumeSnapshot and
              VolumeSnapshotContent objects is successful by ensuring both
              objects point at each other.
            properties:
              boundVolumeSnapshotContentName:
                description: |-
                  Name of the VolumeSnapshotContent object to which this VolumeSnapshot
                  object is bound.
                  If not specified, the VolumeSnapshot object has not been
                  successfully bound to a VolumeSnapshotContent object yet.
                  **Note:** To prevent security issues, verify that binding between
                  VolumeSnapshot and VolumeSnapshotContent objects is successful by ensuring
                  both objects point at each other before using this object.
                type: string
              creationTime:
                description: |-
                  Timestamp when the point-in-time snapshot is taken by the underlying
                  storage system.
                  For dynamic snapshot creation, filled by the
                  snapshot controller with the `creation_time` value returned from CSI
                  `CreateSnapshot` gRPC call.
                  For a pre-existing snapshot, filled with the `creation_time`
                  value returned from the CSI `ListSnapshots` gRPC call if the driver supports it.
                  If not specified, the creation time of the snapshot is unknown.
                format: date-time
                type: string
              error:
                description: |-
                  Last observed error during snapshot creation, if any.
                  Useful to upper level controllers (i.e., application controller)
                  to decide whether to continue waiting for the snapshot to be created
                  based on the error type.
                  The snapshot controller keeps retrying when an error occurs during
                  snapshot creation. Upon success, the field is cleared.
                properties:
                  message:
                    description: |-
                      Details of the encountered error during snapshot creation
                      if specified.
                      **Note:** message may be logged, and it should not contain sensitive
                      information.
                    type: string
                  time:
                    description: |-
                      Timestamp when the error was encountered.
                    format: date-time
                    type: string
                type: object
              readyToUse:
                description: |-
                  Indicates if the snapshot is ready to be used to restore a volume.
                  For dynamic snapshot creation, filled by the
                  snapshot controller with the `ready_to_use` value returned from CSI
                  `CreateSnapshot` gRPC call.
                  For a pre-existing snapshot, filled with the `ready_to_use`
                  value returned from the CSI `ListSnapshots` gRPC call if the driver supports it,
                  otherwise set to `True`.
                  If not specified, the readiness of a snapshot is unknown.
                type: boolean
              restoreSize:
                type: string
                description: |-
                  Minimum size of volume required to create a volume from this snapshot.
                  For dynamic snapshot creation, filled by the
                  snapshot controller with the `size_bytes` value returned from CSI
                  `CreateSnapshot` gRPC call.
                  For a pre-existing snapshot, filled with the `size_bytes`
                  value returned from the CSI `ListSnapshots` gRPC call if the driver supports it.
                  When restoring a volume from this snapshot, the volume size **must not**
                  be smaller than the restoreSize if specified, otherwise the restoration will fail.
                  If not specified, the size is unknown.
                pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                x-kubernetes-int-or-string: true
              volumeGroupSnapshotName:
                description: |-
                  Name of the VolumeGroupSnapshot of which this VolumeSnapshot is a part.
                type: string
            type: object
        required:
        - spec
        type: object
    served: true
    storage: false
    subresources:
      status: {}
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
